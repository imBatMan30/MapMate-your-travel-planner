<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Map Mate - Your Travel Planner</title>
    <link rel="stylesheet" href="mapstyle.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>

    <div class="main">
        <!-- Navigation start here -->
        <div class="nav">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-compass"></i>
                </div>
                <div class="text">
                    <h1>MapMate</h1>
                    <p>Intelligent Travel Planning</p>
                </div>
            </div>
            <div class="nav-links">
                <a href="#features" class="nav-link">
                    <i class="fas fa-star"></i> Features
                </a>
            </div>
        </div>
        <!-- Navigation ends here -->

        <!-- Hero Section -->
        <div class="hero-section">
            <div class="hero-content">
                <h1 class="hero-title">
                    <i class="fas fa-globe-americas"></i>
                    Discover Your Next Adventure
                </h1>
                <p class="hero-subtitle">
                    Experience intelligent travel planning with our sophisticated platform. 
                    From curated destinations to optimized routes, we craft extraordinary journeys tailored to your preferences.
                </p>
                <div class="hero-features">
                    <div class="feature-item">
                        <i class="fas fa-route"></i>
                        <span>Route Optimization</span>
                    </div>
                    <div class="feature-item">
                        <i class="fas fa-map-pin"></i>
                        <span>Curated Premium Destinations</span>
                    </div>
                    <div class="feature-item">
                        <i class="fas fa-concierge-bell"></i>
                        <span>Hotels Recommendations</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main content of the page -->
        <div class="center">
            <div class="heading">
                <h1><i class="fas fa-compass"></i> Configure Your Journey</h1>
                <p>Provide your travel preferences and let our intelligent system create a bespoke itinerary designed specifically for you.</p>
            </div>

            <!-- Error message container -->
            <div id="error-message" class="error-message"></div>

            <form action="/generate" method="post" class="travel-form">
                <div class="form-container">
                    <div class="form-section">
                        <div class="destination">
                            <label class="form-label" for="source">
                                <i class="fas fa-map-marker-alt"></i>
                                Departure Location
                            </label>
                            <div class="input-wrapper">
                                <input type="text" class="form-input" id="source" name="source" placeholder="Enter your starting city" required>
                                <div class="input-icon">
                                    <i class="fas fa-search"></i>
                                </div>
                            </div>
                        </div>

                        <div class="days">
                            <label class="form-label" for="days">
                                <i class="fas fa-calendar-alt"></i>
                                Journey Duration
                            </label>
                            <div class="custom-select-wrapper">
                                <div class="custom-select" id="days-select">
                                    <div class="select-selected">3 Days</div>
                                    <div class="select-items select-hide">
                                        <div data-value="1">1 Day</div>
                                        <div data-value="2">2 Days</div>
                                        <div data-value="3" class="same-as-selected">3 Days</div>
                                        <div data-value="4">4 Days</div>
                                        <div data-value="5">5 Days</div>
                                        <div data-value="6">6 Days</div>
                                        <div data-value="7">7 Days</div>
                                    </div>
                                </div>
                                <input type="hidden" name="days" id="days" value="3" required>
                                <div class="select-icon">
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="travel-section">
                        <h2><i class="fas fa-route"></i> Transportation Mode</h2>
                        <div class="travel-options">
                            <label class="travel-option">
                                <input type="radio" name="medium" value="public" required>
                                <div class="option-card">
                                    <div class="option-icon">ðŸšŠ</div>
                                    <h3>Public Transit</h3>
                                    <p>Sustainable and economical travel using public transportation networks</p>
                                    <div class="option-check">
                                        <i class="fas fa-check"></i>
                                    </div>
                                </div>
                            </label>
                            <label class="travel-option">
                                <input type="radio" name="medium" value="private">
                                <div class="option-card">
                                    <div class="option-icon">ðŸš—</div>
                                    <h3>Private Vehicle</h3>
                                    <p>Flexible and comfortable travel with complete schedule control</p>
                                    <div class="option-check">
                                        <i class="fas fa-check"></i>
                                    </div>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="submit-section">
                    <button type="submit" class="submit-btn">
                        <i class="fas fa-paper-plane"></i>
                        <span>Begin Journey Planning</span>
                        <div class="btn-shine"></div>
                    </button>
                </div>
            </form>
        </div>

        <!-- Features Section -->
        <div id="features" class="features-section">
            <div class="section-header">
                <h2><i class="fas fa-crown"></i> Why Choose MapMate?</h2>
                <p>Experience the future of travel planning with our sophisticated platform</p>
            </div>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-brain"></i>
                    </div>
                    <h3>Intelligent Planning</h3>
                    <p>Advanced algorithms optimize your route for maximum efficiency and enjoyment</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-gem"></i>
                    </div>
                    <h3>Premium Destinations</h3>
                    <p>Handpicked attractions and hidden gems curated by travel experts</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-utensils"></i>
                    </div>
                    <h3>Culinary Excellence</h3>
                    <p>Discover exceptional dining experiences and authentic local cuisine</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-hotel"></i>
                    </div>
                    <h3>Luxury Accommodations</h3>
                    <p>Carefully selected hotels that match your preferences</p>
                </div>
            </div>
        </div>

        <footer>
            <div class="footer-content">
                <div class="footer-icon">
                    <i class="fas fa-heart"></i>
                </div>
                <p>&copy; 2025 MapMate Travel Planner. Crafted with passion for discerning travelers.</p>
            </div>
        </footer>
    </div>

    <!-- Fuel Cost Popup Modal -->
    <div id="fuel-popup" class="fuel-popup-overlay" style="display: none;">
        <div class="fuel-popup">
            <div class="fuel-popup-header">
                <h3><i class="fas fa-gas-pump"></i> Private Vehicle - Fuel Details</h3>
                <button class="close-popup" onclick="closeFuelPopup()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="fuel-popup-content">
                <p>Please provide your vehicle's fuel details to calculate trip costs:</p>
                
                <div class="fuel-input-group">
                    <label for="fuel-economy">
                        <i class="fas fa-tachometer-alt"></i>
                        Fuel Economy (km per liter)
                    </label>
                    <input type="number" id="fuel-economy" step="0.1" min="1" max="50" placeholder="e.g., 15" required>
                    <small>How many kilometers your vehicle travels per liter of fuel</small>
                </div>
                
                <div class="fuel-input-group">
                    <label for="fuel-rate">
                        <i class="fas fa-dollar-sign"></i>
                        Fuel Price (per liter)
                    </label>
                    <input type="number" id="fuel-rate" step="0.01" min="0.1" max="1000" placeholder="e.g., â‚¹90" required>
                    <small>Current fuel price per liter in your currency</small>
                </div>
                
                <div class="fuel-popup-actions">
                    <button class="fuel-btn-cancel" onclick="closeFuelPopup()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                    <button class="fuel-btn-confirm" onclick="confirmFuelDetails()">
                        <i class="fas fa-check"></i> Confirm Details
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Display welcome message if name is present
        const params = new URLSearchParams(window.location.search);
        const name = params.get('name');
        if (name) {
            showWelcomeMessage(name);
        }

        // Display error message if present
        const error = params.get('error');
        if (error) {
            const errorDiv = document.getElementById('error-message');
            errorDiv.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${decodeURIComponent(error)}`;
            errorDiv.style.display = 'block';
        }

        // Enhanced welcome message
        function showWelcomeMessage(name) {
            const welcomeDiv = document.createElement('div');
            welcomeDiv.className = 'welcome-message';
            welcomeDiv.innerHTML = `
                <div class="welcome-content">
                    <i class="fas fa-user-circle"></i>
                    <h3>Welcome back, ${name}! âœ¨</h3>
                    <p>Ready for your next sophisticated journey?</p>
                </div>
            `;
            
            welcomeDiv.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: linear-gradient(135deg, #1a1a2e, #16213e);
                color: white;
                padding: 1.5rem;
                border-radius: 15px;
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
                z-index: 10000;
                animation: slideIn 0.5s ease;
                max-width: 300px;
                border: 1px solid rgba(255, 255, 255, 0.1);
            `;
            
            document.body.appendChild(welcomeDiv);
            
            setTimeout(() => {
                welcomeDiv.style.animation = 'slideOut 0.5s ease';
                setTimeout(() => welcomeDiv.remove(), 500);
            }, 4000);
        }

        // Custom Select Dropdown Functionality
        document.addEventListener('DOMContentLoaded', function() {
            const customSelect = document.getElementById('days-select');
            const selectSelected = customSelect.querySelector('.select-selected');
            const selectItems = customSelect.querySelector('.select-items');
            const hiddenInput = document.getElementById('days');
            
            // Toggle dropdown
            selectSelected.addEventListener('click', function() {
                selectItems.classList.toggle('select-hide');
                selectSelected.classList.toggle('select-arrow-active');
            });
            
            // Handle option selection
            const options = selectItems.querySelectorAll('div');
            options.forEach(option => {
                option.addEventListener('click', function() {
                    const value = this.getAttribute('data-value');
                    const text = this.textContent;
                    
                    // Update selected display
                    selectSelected.textContent = text;
                    
                    // Update hidden input
                    hiddenInput.value = value;
                    
                    // Update selected styling
                    options.forEach(opt => opt.classList.remove('same-as-selected'));
                    this.classList.add('same-as-selected');
                    
                    // Hide dropdown
                    selectItems.classList.add('select-hide');
                    selectSelected.classList.remove('select-arrow-active');
                });
            });
            
            // Close dropdown when clicking outside
            document.addEventListener('click', function(e) {
                if (!customSelect.contains(e.target)) {
                    selectItems.classList.add('select-hide');
                    selectSelected.classList.remove('select-arrow-active');
                }
            });
        });

        // Fuel popup functionality
        let selectedTransportMode = null;
        let fuelEconomy = null;
        let fuelRate = null;

        // Override the existing travel option click handler
        document.querySelectorAll('.travel-option').forEach(label => {
            label.addEventListener('click', (e) => {
                e.preventDefault(); // Prevent default form submission
                
                const input = label.querySelector('input[type="radio"]');
                const transportMode = input.value;
                
                // Remove selected class from all options
                document.querySelectorAll('.travel-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                
                // Add selected class to current option
                label.classList.add('selected');
                
                // Store the selected mode
                selectedTransportMode = transportMode;
                
                if (transportMode === 'private') {
                    // Show fuel popup for private vehicle
                    showFuelPopup();
                } else {
                    // For public transport, directly select the option
                    input.checked = true;
                    fuelEconomy = null;
                    fuelRate = null;
                }
                
                // Add ripple effect
                const ripple = document.createElement('div');
                ripple.className = 'ripple-effect';
                label.appendChild(ripple);
                
                setTimeout(() => ripple.remove(), 600);
            });
        });

        function showFuelPopup() {
            document.getElementById('fuel-popup').style.display = 'flex';
            document.body.style.overflow = 'hidden'; // Prevent background scrolling
        }

        function closeFuelPopup() {
            document.getElementById('fuel-popup').style.display = 'none';
            document.body.style.overflow = 'auto';
            
            // Reset selection if cancelled
            if (selectedTransportMode === 'private') {
                document.querySelectorAll('.travel-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                selectedTransportMode = null;
            }
        }

        function confirmFuelDetails() {
            const economyInput = document.getElementById('fuel-economy');
            const rateInput = document.getElementById('fuel-rate');
            
            const economy = parseFloat(economyInput.value);
            const rate = parseFloat(rateInput.value);
            
            // Validation
            if (!economy || economy <= 0 || economy > 50) {
                showNotification('Please enter a valid fuel economy (1-50 km/L)', 'error');
                economyInput.focus();
                return;
            }
            
            if (!rate || rate <= 0 || rate > 1000) {
                showNotification('Please enter a valid fuel price', 'error');
                rateInput.focus();
                return;
            }
            
            // Store the values
            fuelEconomy = economy;
            fuelRate = rate;
            
            // Select the private vehicle option
            const privateOption = document.querySelector('input[value="private"]');
            privateOption.checked = true;
            
            // Close popup
            closeFuelPopup();
            
            // Show confirmation
            showNotification(`Fuel details saved: ${economy} km/L at ${rate} per liter`, 'success');
        }

        // Override form submission to include fuel data
        const originalFormSubmit = document.querySelector('.travel-form');
        originalFormSubmit.addEventListener('submit', function(e) {
            const selectedMedium = document.querySelector('input[name="medium"]:checked');
            
            if (selectedMedium && selectedMedium.value === 'private') {
                if (!fuelEconomy || !fuelRate) {
                    e.preventDefault();
                    showNotification('Please provide fuel details for private vehicle', 'error');
                    showFuelPopup();
                    return;
                }
                
                // Add fuel data to the form
                const fuelEconomyInput = document.createElement('input');
                fuelEconomyInput.type = 'hidden';
                fuelEconomyInput.name = 'fuelEconomy';
                fuelEconomyInput.value = fuelEconomy;
                
                const fuelRateInput = document.createElement('input');
                fuelRateInput.type = 'hidden';
                fuelRateInput.name = 'fuelRate';
                fuelRateInput.value = fuelRate;
                
                this.appendChild(fuelEconomyInput);
                this.appendChild(fuelRateInput);
            }
        });

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'error' ? 'exclamation-triangle' : type === 'success' ? 'check-circle' : 'info-circle'}"></i>
                ${message}
            `;

            notification.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: ${type === 'error' ? '#e74c3c' : type === 'success' ? '#27ae60' : '#667eea'};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 10px;
                box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                z-index: 10000;
                animation: slideIn 0.5s ease;
                display: flex;
                align-items: center;
                gap: 0.5rem;
                font-weight: 500;
                max-width: 350px;
            `;

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.animation = 'slideOut 0.5s ease';
                setTimeout(() => notification.remove(), 500);
            }, 4000);
        }

        // Add click event to option labels
        document.querySelectorAll('.travel-option').forEach(label => {
            label.addEventListener('click', () => {
                const input = label.querySelector('input[type="radio"]');
                if (input) {
                    // Remove selected class from siblings
                    const parent = label.parentElement;
                    parent.querySelectorAll('.travel-option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    
                    // Add selected class to current option
                    label.classList.add('selected');
                    
                    // Add ripple effect
                    const ripple = document.createElement('div');
                    ripple.className = 'ripple-effect';
                    label.appendChild(ripple);
                    
                    setTimeout(() => ripple.remove(), 600);
                }
            });
        });

        // Form validation and enhancement
        const form = document.querySelector('.travel-form');
        const submitBtn = document.querySelector('.submit-btn');
        
        form.addEventListener('submit', function(e) {
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> <span>Crafting Your Journey...</span>';
            submitBtn.disabled = true;
        });

        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
            
            .ripple-effect {
                position: absolute;
                border-radius: 50%;
                background: rgba(255, 255, 255, 0.6);
                transform: scale(0);
                animation: ripple-animation 0.6s linear;
                pointer-events: none;
                width: 20px;
                height: 20px;
                left: 50%;
                top: 50%;
                margin-left: -10px;
                margin-top: -10px;
            }
            
            @keyframes ripple-animation {
                to {
                    transform: scale(4);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
